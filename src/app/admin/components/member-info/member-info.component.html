<div class="flex flex-col h-full relative">
    <div class="flex flex-col h-full w-full" *ngIf="!dataLoader && userDetail">
        <app-back-btn></app-back-btn>
        <div class="grid grid-cols-1 md:grid-cols-2 bg-gray-500 text-white m-3 p-3 rounded">
            <div class="flex flex-col p-3 justify-center  my-5  h-full overflow-x-auto">
                <div class="flex m-auto">
                    <img class="h-24 w-24 rounded-full border-2 border-blue-700 bg-transparent-black" [src]="userDetail.details.image ? hostingName+'/users/profiles/'+userDetail.details.image : defaultProfile" alt="profile">
                    <div class="flex ml-3 flex-col justify-center items-start">
                        <p class="font-bold w-40 truncate">{{userDetail.details.fullName | titlecase}}</p>
                        <div class="grid grid-cols-2 gap-2  pt-2">
                            <small [ngClass]="userDetail.details.isAdminApprove ? 'px-3 py-1 rounded bg-green-700 text-white' : ' px-3 py-1 rounded bg-pink-700 text-white' ">{{userDetail.details.isAdminApprove ? 'Joined' : 'Joining'}}</small>
                            <small [ngClass]="userDetail.isManager ? 'px-3 py-1 rounded bg-yellow-700 text-white' : ' px-3 py-1 rounded bg-gray-700 text-white' ">{{userDetail.isManager ? 'Manager' : 'User'}}</small>
                        </div>
                        <small *ngIf="greetings" class="flex items-center justify-center w-full px-3 mt-2 py-1 rounded bg-purple-700 text-white">
                            <i class="fa-solid fa-gift"></i>
                            <small class="flex m-auto">
                                Happy Birth Day
                            </small>
                        </small>
                    </div>
                </div>
                <!-- joining -->
                <div *ngIf="!userDetail.details.isAdminApprove" class="grid grid-cols-2 gap-2 mt-2 my-auto">
                    <div (click)="accept()" class="flex justify-center cursor-pointer hover:text-black rounded text-white items-center py-2 px-3 hover:bg-green-500 bg-green-700" id="decline">
                        <i class="fa-sharp fa-solid fa-circle-check"></i>
                        <small *ngIf='!spinnerAcceptTrigger' class="ml-2">accept</small>
                        <mat-spinner *ngIf='spinnerAcceptTrigger' class="ml-2" [diameter]="20"></mat-spinner>
                    </div>
                    <div (click)="decline()"  class="flex justify-center cursor-pointer hover:text-black rounded text-white items-center py-2 px-3 hover:bg-red-500 bg-red-700" id="decline">
                        <i class="fa-solid fa-trash"></i>
                        <small *ngIf='!spinnerDeclineTrigger' class="ml-2" >decline</small>
                        <mat-spinner *ngIf='spinnerDeclineTrigger' class="ml-2" [diameter]="20"></mat-spinner>
                    </div>
                </div>
                <div *ngIf="userDetail.details.isAdminApprove" class="grid grid-cols-1 md:grid-cols-2 gap-2 mt-2 my-auto">
                    <div (click)="edit()" class="flex justify-center shadow-md cursor-pointer hover:text-black rounded text-white items-center py-2 px-3 hover:bg-blue-600 bg-blue-800" id="decline">
                        <i *ngIf='!spinnerDeclineTrigger' class="fa-solid fa-user-pen"></i>
                        <small *ngIf='!spinnerEditTrigger' class="ml-2" >Edit</small>
                        <mat-spinner *ngIf='spinnerEditTrigger' class="ml-2" [diameter]="20"></mat-spinner>
                    </div>
                    <div (click)="remove()" class="flex justify-center shadow-md cursor-pointer hover:text-black rounded text-white items-center py-2 px-3 hover:bg-red-500 bg-red-700" id="decline">
                        <i *ngIf='!spinnerDeclineTrigger' class="fa-solid fa-user-slash"></i>
                        <small *ngIf='!spinnerDeclineTrigger' class="ml-2" >Remove</small>
                        <mat-spinner *ngIf='spinnerDeclineTrigger' class="ml-2" [diameter]="20"></mat-spinner>
                    </div>
                </div>
        </div>
            <div class="grid grid-cols-1 ml-4 text-sm md:text-lg w-full mt-3">
                <div class="flex items-center ">
                    <i class="fa-solid fa-at"></i>
                    <p class="ml-4">Email: {{userDetail.details.email}}</p>
                </div>
                <div class="flex items-center ">
                    <i class="fa-solid fa-arrow-up-1-9"></i>
                    <p class="ml-4">Age: {{Age}} years old</p>
                </div>
                <div class="flex  items-center ">
                    <i class="fa-solid fa-cake-candles"></i>
                    <p class="ml-4">Birth Day: {{ birthDay | date: 'mediumDate'}}</p>
                </div>
                <div class="flex  items-center ">
                    <i class="fa-solid fa-location-dot"></i>
                    <p class="ml-4">Address: {{userDetail.details.address}}</p>
                </div>
                <div class="flex  items-center ">
                    <i class="fa-solid fa-venus-mars"></i>
                    <p class="ml-2">Gender: {{userDetail.details.gender}}</p>
                </div>
            </div>
        </div>
    </div>
    <div class="flex flex-col px-3 h-full w-full" *ngIf="!dataLoader">
        <div class="flex items-center">
            <h2 class="bg-purple-900 px-3 py-1 rounded font-bold text-white">Project Assigned:</h2>
        </div>
        <div *ngIf="project_list.length != 0" class=" grid lg:grid-cols-4 gap-2 md:grid-cols-2 grid-cols-1">
            <div  class="mt-2 border-2 rounded shadow-lg flex flex-col justify-center items-center" *ngFor="let project of project_list">
                <p class="mt-2 font-bold">{{project.project.projectName}}</p>
                <div class="h-48 w-48">
                    <app-doughnut-charts  [tasks]="project.projectJoin"></app-doughnut-charts>
                </div>
                <div routerLink="/dashboard/projects/{{project.project.id}}" class="px-3 cursor-pointer py-1 my-2 border-2 rounded bg-blue-900 hover:bg-blue-700 text-white shadow-md">VISIT</div>
            </div>
        </div>
    </div>

    <!-- loading animation -->

    <div class="flex flex-col h-full w-full" *ngIf="dataLoader">
        <app-back-btn></app-back-btn>
        <div class="grid grid-cols-1 md:grid-cols-2 bg-gray-500 text-white m-3 p-3 rounded">
            <div class="flex flex-col p-3 justify-center  my-5  h-full">
                <div class="flex m-auto">
                    <ngx-skeleton-loader class="flex m-auto" animation="progress" count="1" appearance="circle" [theme]="{
                        height: '70px',
                        width:'70px',
                        'background-color': '#A2ACA5',
                        border: '1px solid white'
                      }"></ngx-skeleton-loader>
                    <div class="grid w-24 ml-3 flex-col pt-4">
                        <!-- Uses `progress` as animation -->
                        <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}" animation="progress"></ngx-skeleton-loader>
                        <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                    </div>
                </div>
                <!-- joining -->
                <div class="grid grid-cols-2 gap-2 mt-2 my-auto">
                    <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                    <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                </div>
            </div>
            <div class="grid grid-cols-1 mt-4 text-sm md:text-lg w-full mt-3">
                <div class="grid items-center">
                    <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                </div>
                <div class="grid  items-center ">
                    <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                </div>
                <div class="grid items-center ">
                    <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                </div>
                <div class="grid  items-center ">
                    <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                </div>
            </div>
        </div>
        <div class="flex flex-col px-3 h-full w-full">
            <div class="grid w-48">
                <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
            </div>
            <div class="mt-2" *ngFor="let _ of fakeArray">
                <div class="w-32">
                    <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                </div>
                <div class="grid">
                    <ngx-skeleton-loader [theme]="{'background-color': '#A2ACA5'}"></ngx-skeleton-loader>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="isShowEditForm" class="absolute top-0 left-0 w-full h-screen bg-transparent-black flex justify-center items-center">
        <div class="bg-white rounded w-full  lg:w-96 py-3 flex flex-col">
            <div class="w-full flex items-center justify-center font-bold mt-2 relative">
                <p>EDIT PROFILE INFO</p>
                <div class="flex justify-end absolute right-5">
                    <div class="p-2 font-bold hover:text-red-500 text-red-700 cursor-pointer" (click)="closeEdit()">X</div>
                </div>
            </div>

            <mat-vertical-stepper class="text-black bg-transparent" [linear]="false" #stepper >

                <!-- first Form -->
        
                <mat-step [stepControl]="firstFormGroup">
                    <form [formGroup]="firstFormGroup" class="grid">
                    <ng-template  matStepLabel><div class="text-black">Authentication Details</div></ng-template>
                    <small class="ml-9 py-1">Email: <span *ngIf="firstFormGroup.controls['email'].invalid && firstFormGroup.controls['email'].value!=''" class="text-red-500">Invalid Email</span></small>
                    <div class="flex">
                        <i class="fa-solid fa-envelope text-xl mr-3"></i>
                      <input placeholder="Enter Email" type="email" formControlName="email" class="w-full py-1 shadow-lg bg-gray-50 rounded" id="outline" required/>
                    </div>
                    <small class="ml-9 pt-1">Password: </small>
                    <div class="flex my-1">
                        <i class="fa-solid fa-key mr-4 text-xl mr-3"></i>
                        <input placeholder="Enter Password" type="password" formControlName="password" class="w-full py-1 shadow-lg bg-gray-50 rounded" id="outline" />
                    </div>
                    <small class="ml-9 pt-1">Confirm Password:</small>
                    <small *ngIf="firstFormGroup.controls['password'].value!=firstFormGroup.controls['password2'].value && firstFormGroup.controls['password2'].value!='' && firstFormGroup.controls['password'].value!=''" class="ml-9 text-red-500">Password & Confirm password not matched!</small>
                    <div class="flex my-1">
                        <i class="fa-solid fa-key mr-4 text-xl mr-3"></i>
                        <input placeholder="Enter Confirm Password" type="password" formControlName="password2" class="w-full py-1 shadow-lg bg-gray-50 rounded" id="outline" />
                    </div>
                    <div class="flex pt-3 justify-center items-center ">
                      <button class="bg-green-700 hover:bg-green-500 px-8 py-1 text-white rounded" mat-button matStepperNext>Next</button>
                    </div>
                  </form>
                </mat-step>
        
                <!-- second form -->
        
                <mat-step [stepControl]="secondFormGroup">
                  <form [formGroup]="secondFormGroup" enctype="multipart/form-data"  class="flex flex-col">
                    <ng-template matStepLabel><div class="text-black">Personal Details</div></ng-template>
                    <input class="hidden" formControlName="image" type="file" (change)="onChange($event)">
                    <div class="w-full flex flex-col items-center">
                        <div class="flex w-full relative items-center justify-center">
                            <img [src]="onLoadFile ? onLoadFile : defaultProfile" class="h-20 w-20 rounded-full shadow-lg border-2 border-blue-500" alt="profile">
                            <div class="absolute -bottom-2 ml-12">
                                <i (click)="imgProfileBtn()" class="fa-solid fa-camera text-xl bg-white px-1 shadow-md border-2 border-blue-700 hover:bg-gray-50 cursor-pointer rounded-full text-black"></i>
                            </div>
                        </div>
                    </div>
                    <small class="ml-9 pt-1">Full Name</small>
                    <div class="flex my-1">
                        <mat-icon class="flex justify-center items-center mr-2" >face</mat-icon>
                        <input placeholder="Full Name"  type="text" formControlName="fullName" class="w-full py-1 shadow-lg bg-gray-50 rounded" id="outline" />
                    </div>
                    <small class="ml-9 pt-1">Address</small>
                    <div class="flex my-1">
                        <mat-icon class="flex justify-center items-center mr-2" >location_on</mat-icon>
                        <input placeholder="Address" type="text" formControlName="address" class="w-full py-1 shadow-lg bg-gray-50 rounded" id="outline" />
                    </div>
                    <small class="ml-9 pt-1">Birth Day</small>
                    <div class="flex my-1">
                        <div class="pt-1 mr-3 ml-1"><i class="fa-solid fa-calendar-days"></i></div>
                        <input placeholder="Enter Your Birth Day" type="date" formControlName="birthDay" class="w-full py-1 shadow-lg bg-gray-50 rounded" id="outline" />
                    </div>
                    <small class="ml-9 pt-1">Gender</small>
                    <div class="flex my-1">
                        <div class="pt-1 mr-3 ml-1"><i class="fa-solid fa-venus-mars"></i></div>
                        <select formControlName="gender"  id="outline" class="w-24 shadow-lg bg-gray-50 rounded">
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                    
                    <div class="grid mt-4 grid-cols-3 grid-rows-1 gap-2">
                      <button class="bg-red-700 py-1 hover:bg-red-500 text-white rounded" mat-button matStepperPrevious>Back</button>
                      <button class="bg-yellow-700 py-1  hover:bg-yellow-500 text-white rounded" mat-button (click)="stepper.reset()">Reset</button>
                      <button *ngIf="!isUpdateButton" (click)="submitUpdateDetails()" class="bg-green-700 py-1  hover:bg-green-500 text-white rounded" mat-button matStepperNext>Save</button>
                      <button *ngIf="isUpdateButton"  class="rounded shadow-md  py-1 bg-green-500 rounded" disabled>
                        <mat-spinner class="m-auto" [diameter]="25"></mat-spinner>
                      </button>
                    </div>
                  </form>
                </mat-step>
              </mat-vertical-stepper>
            
            
           
        </div>
    </div>

</div>


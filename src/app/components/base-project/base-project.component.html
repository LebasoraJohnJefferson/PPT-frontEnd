<div class="flex flex-col full m-auto">
    <div class="p-5">
        <div class="text-yellow-500 font-bold">
            <p class="mr-2 mb-2">{{isSwitchRole ? 'Managing Project' : 'Project Joined'}} :</p> 
            <div class="flex items-center mb-3 ">
            <div (click)="switchRole()" id="admin-container" class="flex cursor-pointer items-center p-2 rounded hover:bg-purple-600 bg-purple-700 text-white relative">
                <span id="number-notify" class="absolute bg-red-500 rounded-full text-xs px-1 -right-1 -top-1">{{isSwitchRole ?   projectsJoined.length : projects.length}}</span>
                <i class="fa-solid fa-repeat text-md"></i>
                <small class="text-white ml-2 text-xs" id="admin-text">Switch to {{isSwitchRole ? 'Collaborator' : 'Admin'}}
                </small>
            </div>
            <div *ngIf="isSwitchRole" id="admin-container" class="flex ml-2 items-center cursor-pointer p-2 mr-2 rounded hover:bg-purple-600 bg-purple-700 text-white" (click)="CreateFormOpen('true')">
                    <i class="fa-solid fa-plus text-whiter text-md"></i>
                    <small class="text-white ml-2 text-xs" id="admin-text">Create Project</small>
                </div>
            </div>
            
            <div class="flex flex-wrap p-5" *ngIf="isSwitchRole">
                
                
                <div *ngFor="let project of projects" id="box-shadow-container" class="flex my-3 borderj mx-2 rounded flex-col justify-center items-center cursor-pointer relative">

                    <div *ngIf="project.projectCategory == 'IT'" class="absolute flex items-center justify-center top-3 rounded-full bg-pink-500 left-2 w-6 h-6 text-white text-">
                        <small class="font-bold">{{project.projectCategory}}</small>
                    </div>
                    <div *ngIf="project.projectCategory == 'ME'" class="absolute flex items-center justify-center top-3 rounded-full bg-blue-500 left-2 w-6 h-6 text-white text-">
                        <small class="font-bold">{{project.projectCategory}}</small>
                    </div>
                    <div *ngIf="project.projectCategory == 'CE'" class="absolute flex items-center justify-center top-3 rounded-full bg-red-500 left-2 w-6 h-6 text-white text-">
                        <small class="font-bold">{{project.projectCategory}}</small>
                    </div>
                    <app-pie-chart [StageInfo]="project.Info" [category]="project.projectCategory" [title]="project.projectName" class="w-48"></app-pie-chart>

                    <div class="w-full flex justify-around  items-center" >
                        <div routerLink="/dashboard/projects/{{project.id}}" class="hover:bg-blue-500 py-2 w-full  bg-transparent text-xs mx-2 mb-2 rounded text-blue-500 hover:text-white font-bold text-center shadow-md" id="view"><i class="fa-solid fa-eye"></i></div>

                        <div id="delete" (click)="initialProjectToDelete(project.id,project.projectName)" class="hover:bg-red-500  mb-2 mx-2 rounded text-center w-full bg-transparent py-2 text-red-500 text-xs hover:text-white font-bold shadow-md"><i class="fa-sharp fa-solid fa-trash"></i></div>
                    </div>
                </div>

            </div>

        </div>
    </div>
    <div class="p-5" *ngIf="!isSwitchRole">
        <div class="flex items-center truncate flex-wrap" *ngIf="projectsJoined.length != 0">
            <div *ngFor="let project of projectsJoined" id="container" class="flex w-full flex-col rounded  p-2 m-2">
                <div class="flex justify-between w-full items-center">
                    <div *ngIf="project.Project.projectCategory == 'IT'" class="flex items-center justify-center top-1 rounded-full bg-pink-500 left-2 w-6 h-6 text-white text-">
                        <small class="font-bold">{{project.Project.projectCategory}}</small>
                    </div>
                    <div *ngIf="project.Project.projectCategory == 'ME'" class=" flex items-center justify-center top-1 rounded-full bg-red-500 left-2 w-6 h-6 text-white text-">
                        <small class="font-bold">{{project.Project.projectCategory}}</small>
                    </div>
                    <div *ngIf="project.Project.projectCategory == 'CE'" class=" flex items-center justify-center top-1 rounded-full bg-blue-500 left-2 w-6 h-6 text-white text-">
                        <small class="font-bold">{{project.Project.projectCategory}}</small>
                    </div>
                    <div class="relative" >
                        <i (click)="openOption(project.Project.id)" class="fa-solid fa-list-ul text-white cursor-pointer"></i>
                        <div  *ngIf="project.Collaborator.isAccepted == false && openNumberById==project.Project.id" class="flex justify-around items-center bg-white absolute top-0 flex-col rounded right-5 shadow-md text-xs">
                            <div class="hover:bg-green-500 transition hover:text-white cursor-pointer w-full p-2" (click)="AcceptInvitationForCollaboration(project.Collaborator.id)">
                                <i  class="fa-solid fa-check cursor-pointer hover:text-green-500 rounded-full mb-2"></i>
                                <small class="ml-2">ACCEPT</small>
                            </div>
                            <div (click)="deleteInvitationForCollaboration(project.Collaborator.id)" class="hover:bg-red-500 text-red-500 transition hover:text-white cursor-pointer w-full p-2" (click)="AcceptInvitationForCollaboration(project.Collaborator.id)">
                                <i  class="fa-solid fa-xmark cursor-pointer  hover:bg-red-500 rounded-full mb-2"></i>
                                <small class="ml-2">DECLINE</small>
                            </div>
                        </div>
                        <div  *ngIf="project.Collaborator.isAccepted == true && openNumberById==project.Project.id" class="flex justify-around items-center bg-white absolute flex-col rounded right-5 top-0 shadow-md  text-xs">
                            <div routerLink="/dashboard/collaborator/{{project.Project.id}}" class="hover:bg-blue-500 hover:text-white text-blue-500  transition hover:text-white cursor-pointer w-full p-2">
                                <i  class="fa-solid fa-eye  cursor-pointer hover:bg-blue-500 rounded-full mb-2"></i>
                                <small class="ml-1">VIEW</small>
                            </div>
                            <div (click)="deleteInvitationForCollaboration(project.Collaborator.id)" class="hover:bg-red-500 text-red-500 transition hover:text-white cursor-pointer w-full p-2" (click)="AcceptInvitationForCollaboration(project.Collaborator.id)">
                                <i  class="fa-solid fa-arrow-right-from-bracket cursor-pointer rounded-full mb-2"></i>
                                <small class="ml-1">LEAVE</small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="w-full flex-col flex items-center justify-center ">
                    <img [src]="project.Project.ownerDetails.image ? project.Project.ownerDetails.image : defaultImage " class="bg-white rounded-full w-12 h-12" alt="">
                </div>
                <p class="truncate text-xs text-white py-2 break-words text-center">{{project.Project.ownerDetails.fullName | uppercase}}</p>
                <div  class=" text-xs p-3 bg-gray-200 rounded  w-98">
                    <span id="msg">
                        <p id="details-text" class="py-2">Details:</p>
                        <div class="py-1 p-2">
                            <i class="fa-solid fa-screwdriver-wrench mr-1"></i>
                            Project name :{{project.Project.projectName}}
                        </div>  
                        <div class="py-1 p-2">
                            <i class="fa-solid fa-briefcase mr-1"></i>
                            Expertise: {{project.Collaborator.expertise}}
                        </div>
                    </span>
                </div>
            </div>
        </div>

        <!-- <div class="flex items-center truncate flex-wrap" *ngIf="projectsJoined.length != 0">
            <div *ngFor="let project of projectsJoined" class="text-white" >
                <div class="border w-40 h-54 rounded mx-2">
                    <div class="relative m-1 mt-2 flex items-center justify-around w-full">
                        <div *ngIf="project.Project.projectCategory == 'IT'" class="flex items-center justify-center top-1 rounded-full bg-yellow-500 left-2 w-6 h-6 text-white text-">
                            <small class="font-bold">{{project.Project.projectCategory}}</small>
                        </div>
                        <div *ngIf="project.Project.projectCategory == 'ME'" class=" flex items-center justify-center top-1 rounded-full bg-blue-500 left-2 w-6 h-6 text-white text-">
                            <small class="font-bold">{{project.Project.projectCategory}}</small>
                        </div>
                        <div *ngIf="project.Project.projectCategory == 'CE'" class=" flex items-center justify-center top-1 rounded-full bg-red-500 left-2 w-6 h-6 text-white text-">
                            <small class="font-bold">{{project.Project.projectCategory}}</small>
                        </div>
                        <div *ngIf="project.Collaborator.isAccepted == false" class="w-1/2 flex justify-around items-center">
                            <i (click)="AcceptInvitationForCollaboration(project.Collaborator.id)" class="fa-solid fa-check cursor-pointer bg-green-500 hover:bg-green-500 py-1 px-1 rounded-full"></i>
                            <i (click)="deleteInvitationForCollaboration(project.Collaborator.id)" class="fa-solid fa-xmark cursor-pointer bg-red-500 hover:bg-red-400 py-1 px-2 rounded-full"></i>
                        </div>
                        <div *ngIf="project.Collaborator.isAccepted != false" class="w-1/2 flex justify-around items-center">
                            <i class="fa-solid fa-eye  cursor-pointer bg-blue-500 hover:bg-blue-400 p-1 rounded-full"></i>
                            <i (click)="leaveProject(project.Collaborator.id)" class="fa-solid fa-arrow-right-from-bracket cursor-pointer bg-red-500 hover:bg-red-400 p-1 rounded-full"></i>
                        </div>
                    </div>
                    <div>
                        <p class="text-white bg-yellow-700 truncate font-bold  text-center px-3 border mt-2">
                            {{project.Project.projectName | uppercase}}
                        </p>
                        <div class="mt-2 flex flex-col">
                            <small class="bg-purple-900 font-bold mx-2 my-1 text-xs px-2 py-1 rounded text-center">OWNER</small>
                            <small class="text-center text-yellow-400 truncate my-1">{{project.Project.ownerDetails.fullName}}</small>
                        </div>
                        <div class="flex flex-col">
                            <small class="bg-purple-900 font-bold mx-2 px-2 py-1 text-xs rounded text-center">JOB</small>
                            <small class="text-center text-yellow-400 truncate my-1">{{project.Collaborator.expertise}}</small>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
    </div>
</div>


<div *ngIf="isCreateFormOpen" class="fixed top-0 left-0 text-yellow-600 font-bold flex items-center justify-center h-screen w-screen" id="CreateProject">
    <div class="bg-black rounded relative" id="formContainer">
        <div class="absolute flex w-full justify-end">
            <p (click)="CreateFormOpen('false')" class="mr-10 mt-5 cursor-pointer text-2xl text-red-700 hover:text-red-500">X</p>
        </div>
        <div class="text-center mt-10 text-white py-2">CREATE PROJECT:</div>
        <form (ngSubmit)="submitCreateProject()" [formGroup]="createBaseProjectFormGroup" class="grid">
            <div class="grid gap-2 px-3">
                <div>
                    <small>Project Name:</small>
                    <input formControlName="projectName" class="w-full rounded py-1" placeholder="Enter project name...">
                </div>
                

                <div class="mt-2 flex flex-col">
                    <small>Project Category :</small>
                    <select formControlName="projectCategory" class="rounded py-1 text-black">
                        <option value="IT">Information Technology</option>
                        <option value="CE">Civil Engineering</option>
                        <option value="ME">Mechanical Engineering</option>
                    </select>
                </div>
                <div class="mt-5 flex justify-center items-center">
                    <button type="submit" class="w-32 bg-green-700 hover:bg-green-500 py-1 rounded text-white font-bold">CREATE</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div *ngIf="isDeleteProjectOpen"  class="w-full h-screen z-20 flex items-center justify-center  fixed top-0 left-0" id="toDeleteContainer">
    <div class="bg-gray-900 text-yellow-500 w-96 py-3 rounded relative">
        <p class="truncate text-center py-2 my-2">Are you sure you want to remove  {{name}} ?</p>
        <div class="flex justify-around items-center">
            <div (click)="deleteProject()" class="bg-red-700 cursor-pointer hover:bg-red-500 text-white py-1 px-2 rounded">
                <i class="fa-solid fa-user-xmark mr-2"></i>REMOVE</div>
            <div (click)="initialProjectToDelete(-1,'')" class="bg-blue-700 cursor-pointer hover:bg-blue-500 text-white py-1 px-2 rounded">
                <i class="fa-solid fa-ban mr-1"></i>
                CANCEL
            </div>
        </div>
    </div>
</div>

<div class="flex items-center justify-center" *ngIf="(projectsJoined.length == 0 && !isSwitchRole) || (projects.length ==0 && isSwitchRole)">
    <div class="mt-5 flex flex-col items-center justify-center">
        <div id="text" class="text-white  text-center font-bold text-3xl">{{isSwitchRole ? 'No Project(s)' : 'No Project Assigned'}} found!</div>
        <img id="image-no-porject" src="../../../assets/images/no-project.gif" alt="">
    </div>
</div>